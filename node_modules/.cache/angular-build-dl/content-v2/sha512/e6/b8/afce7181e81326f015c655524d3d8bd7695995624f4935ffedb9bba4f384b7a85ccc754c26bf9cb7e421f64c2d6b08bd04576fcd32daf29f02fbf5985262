(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{"14+f":function(e,t,n){"use strict";n.r(t),n.d(t,"PushNotificationModule",function(){return q});var i=n("ofXK"),s=n("tyNb"),o=n("tk/3"),r=n("fXoL"),a=n("mrSG"),c=n("Wcq6"),u=n.n(c),l=n("LRne"),d=n("EY2u"),g=n("z6cu"),b=n("HDdC"),p=n("GyhO"),j=n("tf+s"),h=n("pxpQ"),f=n("eIep"),O=n("lJxs"),m=n("UXun"),k=n("aGrj"),A=n("JIr8"),y=n("5+tZ"),v=n("xbPD"),w=n("spgP");const M=new r.InjectionToken("angularfire2.messaging.vapid-key"),P=new r.InjectionToken("angularfire2.messaging.service-worker-registeration"),T=parseInt(u.a.SDK_VERSION,10)<8;let x=(()=>{class e{constructor(e,t,s,o,r,c){const M=new w.d(o),P=c,x=Object(l.a)(void 0).pipe(Object(j.a)(M.outsideAngular),Object(h.b)(M.insideAngular),Object(f.a)(()=>Object(i.A)(s)?d.a:n.e(20).then(n.bind(null,"dB9c"))),Object(O.a)(()=>Object(w.g)(e,o,t)),Object(f.a)(e=>Object(w.f)(e.name+".messaging","AngularFireMessaging",e,()=>Object(a.b)(this,void 0,void 0,function*(){const t=e.messaging();return T&&(r&&t.usePublicVapidKey(r),P&&t.useServiceWorker(yield P)),t}),[r,P])),Object(m.a)({bufferSize:1,refCount:!1}));this.requestPermission=x.pipe(Object(j.a)(M.outsideAngular),Object(h.b)(M.insideAngular),Object(f.a)(e=>u.a.messaging.isSupported()?e.requestPermission():Object(g.a)("Not supported."))),this.getToken=x.pipe(Object(j.a)(M.outsideAngular),Object(h.b)(M.insideAngular),Object(f.a)(e=>Object(a.b)(this,void 0,void 0,function*(){if(u.a.messaging.isSupported()&&"granted"===Notification.permission){if(T)return yield e.getToken();{const t=P?yield P:null;return yield e.getToken({vapidKey:r,serviceWorkerRegistration:t})}}return null})));const N=new b.a(e=>{navigator.permissions.query({name:"notifications"}).then(t=>{t.onchange=()=>e.next()})}),S=x.pipe(Object(j.a)(M.outsideAngular),Object(h.b)(M.insideAngular),Object(k.a)(N),Object(k.a)(this.getToken));return this.tokenChanges=x.pipe(Object(j.a)(M.outsideAngular),Object(h.b)(M.insideAngular),Object(f.a)(()=>u.a.messaging.isSupported()?Object(p.a)(this.getToken,S):d.a)),this.messages=x.pipe(Object(j.a)(M.outsideAngular),Object(h.b)(M.insideAngular),Object(f.a)(e=>u.a.messaging.isSupported()?new b.a(t=>e.onMessage(e=>t.next(e),e=>t.error(e),()=>t.complete())):d.a)),this.requestToken=Object(l.a)(void 0).pipe(Object(j.a)(M.outsideAngular),Object(h.b)(M.insideAngular),Object(f.a)(()=>this.requestPermission),Object(A.a)(()=>Object(l.a)(null)),Object(y.b)(()=>this.tokenChanges)),this.deleteToken=e=>x.pipe(Object(j.a)(M.outsideAngular),Object(h.b)(M.insideAngular),Object(f.a)(t=>t.deleteToken(e||void 0)),Object(v.a)(!1)),Object(w.i)(this,x,o)}}return e.\u0275fac=function(t){return new(t||e)(r["\u0275\u0275inject"](w.c),r["\u0275\u0275inject"](w.b,8),r["\u0275\u0275inject"](r.PLATFORM_ID),r["\u0275\u0275inject"](r.NgZone),r["\u0275\u0275inject"](M,8),r["\u0275\u0275inject"](P,8))},e.\u0275prov=Object(r["\u0275\u0275defineInjectable"])({factory:function(){return new e(Object(r["\u0275\u0275inject"])(w.c),Object(r["\u0275\u0275inject"])(w.b,8),Object(r["\u0275\u0275inject"])(r.PLATFORM_ID),Object(r["\u0275\u0275inject"])(r.NgZone),Object(r["\u0275\u0275inject"])(M,8),Object(r["\u0275\u0275inject"])(P,8))},token:e,providedIn:"any"}),e})();Object(w.e)(x,[{deleteToken:null,getToken:null,onMessage:null,onBackgroundMessage:null,onTokenRefresh:null,requestPermission:null,setBackgroundMessageHandler:null,useServiceWorker:null,usePublicVapidKey:null}]);const N=[{path:"send-notification",component:(()=>{class e{constructor(e,t){this.http=e,this.angularFirebaseMessaging=t,this._token="DemitTalha",this.title="NotificationTitle",this.text="Notification Text",this.type="Notification",this.senderid="",this.senderimage=""}ngOnInit(){this.send()}sendPushMessage(){if(this.createuniqueid(),null==this._token)return void console.log("Unable to send FCM message, no token exists.");const e=this.constructFCMPayload("/topics/"+this._token);console.log(this._token);try{var t=new o.d({"Content-Type":"application/json; charset=UTF-8",Authorization:"key=AAAAAK4x17k:APA91bEGgK5wCHTH7cKSrhJ8hfEjYpP3S7-xuui7cwxUfGZDeJGBpsvCZNceuMD20DxLsDYKMuHUKmruuk0nBeJpZE1ApwmsJUPX6fWlZj-V-RhYzE72icsycpqmJFcd-Fri9mu662EN"});return(new o.d).set("Authorization","key=AAAAAK4x17k:APA91bEGgK5wCHTH7cKSrhJ8hfEjYpP3S7-xuui7cwxUfGZDeJGBpsvCZNceuMD20DxLsDYKMuHUKmruuk0nBeJpZE1ApwmsJUPX6fWlZj-V-RhYzE72icsycpqmJFcd-Fri9mu662EN"),this.http.post("https://fcm.googleapis.com/fcm/send",e,{headers:t})}catch(n){console.log(n)}}constructFCMPayload(e){return console.log(this.uniquemessageid),JSON.stringify({to:e,data:{via:"She Reign",count:this.uniquemessageid,title:this.title,body:this.text,type:this.type,senderid:this.senderid,senderimage:this.senderimage},notification:{title:this.title,body:this.text}})}createuniqueid(){var e=Math.floor(999999999e4*Math.random()+1e4);Math.random().toString(36).substring(2,15),Math.random().toString(36).substring(2,15),this.uniquemessageid=(e+this.text).split("").sort(function(){return.5-Math.random()}).join("")}send(){this.sendPushMessage().subscribe(e=>{console.log(e)})}requestPerm(e){this.angularFirebaseMessaging.requestToken.subscribe(e=>{console.log(e),this._token=e,localStorage.setItem("token",e)},e=>{console.error("No Permission "+e)})}}return e.\u0275fac=function(t){return new(t||e)(r["\u0275\u0275directiveInject"](o.b),r["\u0275\u0275directiveInject"](x))},e.\u0275cmp=r["\u0275\u0275defineComponent"]({type:e,selectors:[["app-CreateNotification"]],decls:2,vars:0,template:function(e,t){1&e&&(r["\u0275\u0275elementStart"](0,"p"),r["\u0275\u0275text"](1," CreateNotification works!\n"),r["\u0275\u0275elementEnd"]())},styles:[""]}),e})()}];let S=(()=>{class e{}return e.\u0275mod=r["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=r["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[s.g.forChild(N)],s.g]}),e})(),q=(()=>{class e{}return e.\u0275mod=r["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=r["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[i.c,S]]}),e})()}}]);