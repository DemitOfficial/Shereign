{"version":3,"sources":["../../../projects/ngx-mask-lib/src/lib/config.ts","../../../node_modules/tslib/tslib.es6.js","../../../projects/ngx-mask-lib/src/lib/mask-applier.service.ts","../../../projects/ngx-mask-lib/src/lib/mask.service.ts","../../../projects/ngx-mask-lib/src/lib/mask.directive.ts","../../../projects/ngx-mask-lib/src/lib/mask.pipe.ts","../../../projects/ngx-mask-lib/src/lib/ngx-mask.module.ts","../../../projects/ngx-mask-lib/src/lib/custom-keyboard-event.ts"],"names":["config","InjectionToken","NEW_CONFIG","INITIAL_CONFIG","initialConfig","suffix","prefix","thousandSeparator","decimalMarker","clearIfNotMatch","showTemplate","showMaskTyped","placeHolderCharacter","dropSpecialCharacters","hiddenInput","undefined","shownMaskExpression","separatorLimit","allowNegativeNumbers","validation","specialCharacters","patterns","0","pattern","RegExp","9","optional","X","symbol","A","S","d","m","M","H","h","s","timeMasks","withoutValidation","extendStatics","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","__generator","body","f","y","t","g","_","label","sent","trys","ops","verb","throw","return","Symbol","iterator","this","n","v","op","TypeError","pop","length","push","create","__read","o","r","i","ar","error","MaskApplierService","_config","_this","maskExpression","actualValue","_formatWithSeparators","str","thousandSeparatorChar","decimalChar","precision","x","split","decimals","res","replace","slice","rgx","test","substr","percentage","Number","getPrecision","Infinity","checkInputPrecision","inputValue","precisionRegEx","_charToRegExpExpression","precisionMatch","match","diff","substring","endsWith","_shift","Set","maskSpecialCharacters","maskAvailablePatterns","applyMaskWithPattern","maskAndPattern","_a","mask","customPattern","applyMask","position","cb","cursor","multi","backspaceShift","shift","stepBack","inputArray","toString","ipError","filter","arr","cpfCnpjError","startsWith","_stripToDecimal","indexOf","base","thousandSeperatorCharEscaped","decimalMarkerEscaped","invalidChars","invalidCharRegexp","strForSep","commaShift","shiftStep","add","clear","inputSymbol","_checkSymbolMask","monthsCount","withoutDays","day1monthInput","includes","day2monthInput","day1monthPaste","day2monthPaste","_findSpecialChar","newPosition","has","actualShift","find","val","maskSymbol","idx","join","char","Injectable","Inject","args","MaskService","document","_elementRef","_renderer","_super","isNumberValue","maskIsShown","selStart","selEnd","writingValue","onChange","_formElement","nativeElement","__","constructor","__extends","showMaskInInput","formControlResult","getSymbol","newInputValue","actualResult","splice","shiftTypedSymbols","Boolean","getActualValue","item","hideInput","resLen","prefNmask","countSkipedSymbol","_numberSkipedSymbols","regex","exec","applyValueChanges","activeElement","clearIfNotMatchFn","map","curr","index","compare","symbolToReplace","currSymbol","replaceSymbol","inputVal","Error","_checkForIp","_checkForCpfCnpj","formElementProperty","defineProperty","_b","name","setProperty","checkSpecialCharAmount","removeMask","_removeMask","_removeSuffix","_removePrefix","concat","cpf","cnpj","isArray","_checkSymbols","specialCharactersForRemove","_regExpForRemove","_retrieveSeparatorValue","separatorPrecision","_retrieveSeparatorPrecision","separatorValue","_checkPrecision","maskExpretion","matcher","separatorExpression","toFixed","DOCUMENT","ElementRef","Renderer2","MaskDirective","_maskService","_maskValue","_position","_maskExpressionArray","onTouch","ngOnChanges","changes","currentValue","sort","a","c","_applyMask","validate","_createValidationError","_validateTime","counterOfOpt","key","this_1","lastIndexOf","opt","onInput","el","target","_inputValue","_setMask","selectionStart","caretShift","_backspaceShift","positionToApply","_code","_getActualInputLength","setSelectionRange","onBlur","onFocus","selectionEnd","keyCode","focus","nextValue","onKeyDown","code","preventDefault","suffixCheckOnPressDelete","cursorStart","readOnly","ctrlKey","metaKey","writeValue","String","registerOnChange","fn","registerOnTouched","setDisabledState","isDisabled","onModelChange","_repeatPatternSymbols","maskExp","reduce","accum","currval","_start","_end","repeatNumber","rowMaskLen","requiredMask","some","Directive","selector","providers","provide","NG_VALUE_ACCESSOR","useExisting","forwardRef","NG_VALIDATORS","Input","HostListener","MaskPipe","transform","Pipe","pure","NgxMaskModule","forRoot","configValue","ngModule","useValue","useFactory","_configFactory","deps","forChild","initConfig","Function","assign","NgModule","exports","declarations","commonjsGlobal","globalThis","window","global","self","KeyboardEvent","_eventType","_init"],"mappings":"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","sourcesContent":["import { InjectionToken } from '@angular/core';\n\nexport interface IConfig {\n  suffix: string;\n  prefix: string;\n  thousandSeparator: string;\n  decimalMarker: '.' | ',';\n  clearIfNotMatch: boolean;\n  showTemplate: boolean;\n  showMaskTyped: boolean;\n  placeHolderCharacter: string;\n  shownMaskExpression: string;\n  dropSpecialCharacters: boolean | string[];\n  specialCharacters: string[];\n  hiddenInput: boolean | undefined;\n  validation: boolean;\n  separatorLimit: string;\n  allowNegativeNumbers: boolean;\n  patterns: {\n    [character: string]: {\n      pattern: RegExp;\n      optional?: boolean;\n      symbol?: string;\n    };\n  };\n}\n\nexport type optionsConfig = Partial<IConfig>;\nexport const config: InjectionToken<IConfig> = new InjectionToken('config');\nexport const NEW_CONFIG: InjectionToken<IConfig> = new InjectionToken('NEW_CONFIG');\nexport const INITIAL_CONFIG: InjectionToken<IConfig> = new InjectionToken('INITIAL_CONFIG');\n\nexport const initialConfig: IConfig = {\n  suffix: '',\n  prefix: '',\n  thousandSeparator: ' ',\n  decimalMarker: '.',\n  clearIfNotMatch: false,\n  showTemplate: false,\n  showMaskTyped: false,\n  placeHolderCharacter: '_',\n  dropSpecialCharacters: true,\n  hiddenInput: undefined,\n  shownMaskExpression: '',\n  separatorLimit: '',\n  allowNegativeNumbers: false,\n  validation: true,\n  // tslint:disable-next-line: quotemark\n  specialCharacters: ['-', '/', '(', ')', '.', ':', ' ', '+', ',', '@', '[', ']', '\"', \"'\"],\n  patterns: {\n    '0': {\n      pattern: new RegExp('\\\\d'),\n    },\n    '9': {\n      pattern: new RegExp('\\\\d'),\n      optional: true,\n    },\n    X: {\n      pattern: new RegExp('\\\\d'),\n      symbol: '*',\n    },\n    A: {\n      pattern: new RegExp('[a-zA-Z0-9]'),\n    },\n    S: {\n      pattern: new RegExp('[a-zA-Z]'),\n    },\n    d: {\n      pattern: new RegExp('\\\\d'),\n    },\n    m: {\n      pattern: new RegExp('\\\\d'),\n    },\n    M: {\n      pattern: new RegExp('\\\\d'),\n    },\n    H: {\n      pattern: new RegExp('\\\\d'),\n    },\n    h: {\n      pattern: new RegExp('\\\\d'),\n    },\n    s: {\n      pattern: new RegExp('\\\\d'),\n    },\n  },\n};\n\nexport const timeMasks: string[] = ['Hh:m0:s0', 'Hh:m0', 'm0:s0'];\n\nexport const withoutValidation: string[] = [\n  'percent',\n  'Hh',\n  's0',\n  'm0',\n  'separator',\n  'd0/M0/0000',\n  'd0/M0',\n  'd0',\n  'M0',\n];\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","import { Inject, Injectable } from '@angular/core';\n\nimport { config, IConfig } from './config';\n\n@Injectable()\nexport class MaskApplierService {\n  public dropSpecialCharacters: IConfig['dropSpecialCharacters'];\n  public hiddenInput: IConfig['hiddenInput'];\n  public showTemplate!: IConfig['showTemplate'];\n  public clearIfNotMatch!: IConfig['clearIfNotMatch'];\n  public maskExpression: string = '';\n  public actualValue: string = '';\n  public shownMaskExpression: string = '';\n  public maskSpecialCharacters!: IConfig['specialCharacters'];\n  public maskAvailablePatterns!: IConfig['patterns'];\n  public prefix!: IConfig['prefix'];\n  public suffix!: IConfig['suffix'];\n  public thousandSeparator!: IConfig['thousandSeparator'];\n  public decimalMarker!: IConfig['decimalMarker'];\n  public customPattern!: IConfig['patterns'];\n  public ipError?: boolean;\n  public cpfCnpjError?: boolean;\n  public showMaskTyped!: IConfig['showMaskTyped'];\n  public placeHolderCharacter!: IConfig['placeHolderCharacter'];\n  public validation: IConfig['validation'];\n  public separatorLimit: IConfig['separatorLimit'];\n  public allowNegativeNumbers: IConfig['allowNegativeNumbers'];\n\n  private _shift!: Set<number>;\n\n  public constructor(@Inject(config) protected _config: IConfig) {\n    this._shift = new Set();\n    this.clearIfNotMatch = this._config.clearIfNotMatch;\n    this.dropSpecialCharacters = this._config.dropSpecialCharacters;\n    this.maskSpecialCharacters = this._config.specialCharacters;\n    this.maskAvailablePatterns = this._config.patterns;\n    this.prefix = this._config.prefix;\n    this.suffix = this._config.suffix;\n    this.thousandSeparator = this._config.thousandSeparator;\n    this.decimalMarker = this._config.decimalMarker;\n    this.hiddenInput = this._config.hiddenInput;\n    this.showMaskTyped = this._config.showMaskTyped;\n    this.placeHolderCharacter = this._config.placeHolderCharacter;\n    this.validation = this._config.validation;\n    this.separatorLimit = this._config.separatorLimit;\n    this.allowNegativeNumbers = this._config.allowNegativeNumbers;\n  }\n\n  public applyMaskWithPattern(inputValue: string, maskAndPattern: [string, IConfig['patterns']]): string {\n    const [mask, customPattern] = maskAndPattern;\n    this.customPattern = customPattern;\n    return this.applyMask(inputValue, mask);\n  }\n  public applyMask(inputValue: string, maskExpression: string, position: number = 0, cb: Function = () => {}): string {\n    if (inputValue === undefined || inputValue === null || maskExpression === undefined) {\n      return '';\n    }\n    let cursor = 0;\n    let result = '';\n    let multi = false;\n    let backspaceShift = false;\n    let shift = 1;\n    let stepBack = false;\n    if (inputValue.slice(0, this.prefix.length) === this.prefix) {\n      inputValue = inputValue.slice(this.prefix.length, inputValue.length);\n    }\n    if (!!this.suffix && inputValue.endsWith(this.suffix)) {\n      inputValue = inputValue.slice(0, inputValue.length - this.suffix.length);\n    }\n    const inputArray: string[] = inputValue.toString().split('');\n    if (maskExpression === 'IP') {\n      this.ipError = !!(inputArray.filter((i: string) => i === '.').length < 3 && inputArray.length < 7);\n      maskExpression = '099.099.099.099';\n    }\n    const arr: string[] = [];\n    for (let i = 0; i < inputValue.length; i++) {\n      if (inputValue[i].match('\\\\d')) {\n        arr.push(inputValue[i]);\n      }\n    }\n    if (maskExpression === 'CPF_CNPJ') {\n      this.cpfCnpjError = !!(arr.length !== 11 && arr.length !== 14);\n      if (arr.length > 11) {\n        maskExpression = '00.000.000/0000-00';\n      } else {\n        maskExpression = '000.000.000-00';\n      }\n    }\n    if (maskExpression.startsWith('percent')) {\n      if (inputValue.match('[a-z]|[A-Z]') || inputValue.match(/[-!$%^&*()_+|~=`{}\\[\\]:\";'<>?,\\/.]/)) {\n        inputValue = this._stripToDecimal(inputValue);\n        const precision: number = this.getPrecision(maskExpression);\n        inputValue = this.checkInputPrecision(inputValue, precision, this.decimalMarker);\n      }\n      if (inputValue.indexOf('.') > 0 && !this.percentage(inputValue.substring(0, inputValue.indexOf('.')))) {\n        const base: string = inputValue.substring(0, inputValue.indexOf('.') - 1);\n        inputValue = `${base}${inputValue.substring(inputValue.indexOf('.'), inputValue.length)}`;\n      }\n      if (this.percentage(inputValue)) {\n        result = inputValue;\n      } else {\n        result = inputValue.substring(0, inputValue.length - 1);\n      }\n    } else if (maskExpression.startsWith('separator')) {\n      if (\n        inputValue.match('[wа-яА-Я]') ||\n        inputValue.match('[ЁёА-я]') ||\n        inputValue.match('[a-z]|[A-Z]') ||\n        inputValue.match(/[-@#!$%\\\\^&*()_£¬'+|~=`{}\\[\\]:\";<>.?\\/]/) ||\n        inputValue.match('[^A-Za-z0-9,]')\n      ) {\n        inputValue = this._stripToDecimal(inputValue);\n      }\n\n      inputValue =\n        inputValue.length > 1 && inputValue[0] === '0' && inputValue[1] !== this.decimalMarker\n          ? inputValue.slice(1, inputValue.length)\n          : inputValue;\n\n      // TODO: we had different rexexps here for the different cases... but tests dont seam to bother - check this\n      //  separator: no COMMA, dot-sep: no SPACE, COMMA OK, comma-sep: no SPACE, COMMA OK\n\n      const thousandSeperatorCharEscaped: string = this._charToRegExpExpression(this.thousandSeparator);\n      const decimalMarkerEscaped: string = this._charToRegExpExpression(this.decimalMarker);\n      const invalidChars: string = '@#!$%^&*()_+|~=`{}\\\\[\\\\]:\\\\s,\\\\.\";<>?\\\\/'\n        .replace(thousandSeperatorCharEscaped, '')\n        .replace(decimalMarkerEscaped, '');\n\n      const invalidCharRegexp: RegExp = new RegExp('[' + invalidChars + ']');\n\n      if (inputValue.match(invalidCharRegexp)) {\n        inputValue = inputValue.substring(0, inputValue.length - 1);\n      }\n\n      const precision: number = this.getPrecision(maskExpression);\n      inputValue = this.checkInputPrecision(inputValue, precision, this.decimalMarker);\n      const strForSep: string = inputValue.replace(new RegExp(thousandSeperatorCharEscaped, 'g'), '');\n      result = this._formatWithSeparators(strForSep, this.thousandSeparator, this.decimalMarker, precision);\n\n      const commaShift: number = result.indexOf(',') - inputValue.indexOf(',');\n      const shiftStep: number = result.length - inputValue.length;\n\n      if (shiftStep > 0 && result[position] !== ',') {\n        backspaceShift = true;\n        let _shift = 0;\n        do {\n          this._shift.add(position + _shift);\n          _shift++;\n        } while (_shift < shiftStep);\n      } else if (\n        (commaShift !== 0 && position > 0 && !(result.indexOf(',') >= position && position > 3)) ||\n        (!(result.indexOf('.') >= position && position > 3) && shiftStep <= 0)\n      ) {\n        this._shift.clear();\n        backspaceShift = true;\n        shift = shiftStep;\n        position += shiftStep;\n        this._shift.add(position);\n      } else {\n        this._shift.clear();\n      }\n    } else {\n      for (\n        // tslint:disable-next-line\n        let i: number = 0, inputSymbol: string = inputArray[0];\n        i < inputArray.length;\n        i++, inputSymbol = inputArray[i]\n      ) {\n        if (cursor === maskExpression.length) {\n          break;\n        }\n        if (this._checkSymbolMask(inputSymbol, maskExpression[cursor]) && maskExpression[cursor + 1] === '?') {\n          result += inputSymbol;\n          cursor += 2;\n        } else if (\n          maskExpression[cursor + 1] === '*' &&\n          multi &&\n          this._checkSymbolMask(inputSymbol, maskExpression[cursor + 2])\n        ) {\n          result += inputSymbol;\n          cursor += 3;\n          multi = false;\n        } else if (this._checkSymbolMask(inputSymbol, maskExpression[cursor]) && maskExpression[cursor + 1] === '*') {\n          result += inputSymbol;\n          multi = true;\n        } else if (\n          maskExpression[cursor + 1] === '?' &&\n          this._checkSymbolMask(inputSymbol, maskExpression[cursor + 2])\n        ) {\n          result += inputSymbol;\n          cursor += 3;\n        } else if (\n          this._checkSymbolMask(inputSymbol, maskExpression[cursor]) ||\n          (this.hiddenInput &&\n            this.maskAvailablePatterns[maskExpression[cursor]] &&\n            this.maskAvailablePatterns[maskExpression[cursor]].symbol === inputSymbol)\n        ) {\n          if (maskExpression[cursor] === 'H') {\n            if (Number(inputSymbol) > 2) {\n              cursor += 1;\n              const shiftStep: number = /[*?]/g.test(maskExpression.slice(0, cursor)) ? inputArray.length : cursor;\n              this._shift.add(shiftStep + this.prefix.length || 0);\n              i--;\n              continue;\n            }\n          }\n          if (maskExpression[cursor] === 'h') {\n            if (result === '2' && Number(inputSymbol) > 3) {\n              cursor += 1;\n              i--;\n              continue;\n            }\n          }\n          if (maskExpression[cursor] === 'm') {\n            if (Number(inputSymbol) > 5) {\n              cursor += 1;\n              const shiftStep: number = /[*?]/g.test(maskExpression.slice(0, cursor)) ? inputArray.length : cursor;\n              this._shift.add(shiftStep + this.prefix.length || 0);\n              i--;\n              continue;\n            }\n          }\n          if (maskExpression[cursor] === 's') {\n            if (Number(inputSymbol) > 5) {\n              cursor += 1;\n              const shiftStep: number = /[*?]/g.test(maskExpression.slice(0, cursor)) ? inputArray.length : cursor;\n              this._shift.add(shiftStep + this.prefix.length || 0);\n              i--;\n              continue;\n            }\n          }\n          const daysCount = 31;\n          if (maskExpression[cursor] === 'd') {\n            if (Number(inputValue.slice(cursor, cursor + 2)) > daysCount || inputValue[cursor + 1] === '/') {\n              cursor += 1;\n              const shiftStep: number = /[*?]/g.test(maskExpression.slice(0, cursor)) ? inputArray.length : cursor;\n              this._shift.add(shiftStep + this.prefix.length || 0);\n              i--;\n              continue;\n            }\n          }\n          if (maskExpression[cursor] === 'M') {\n            const monthsCount = 12;\n            // mask without day\n            const withoutDays: boolean =\n              cursor === 0 &&\n              (Number(inputSymbol) > 2 ||\n                Number(inputValue.slice(cursor, cursor + 2)) > monthsCount ||\n                inputValue[cursor + 1] === '/');\n            // day<10 && month<12 for input\n            const day1monthInput: boolean =\n              inputValue.slice(cursor - 3, cursor - 1).includes('/') &&\n              ((inputValue[cursor - 2] === '/' &&\n                Number(inputValue.slice(cursor - 1, cursor + 1)) > monthsCount &&\n                inputValue[cursor] !== '/') ||\n                inputValue[cursor] === '/' ||\n                (inputValue[cursor - 3] === '/' &&\n                  Number(inputValue.slice(cursor - 2, cursor)) > monthsCount &&\n                  inputValue[cursor - 1] !== '/') ||\n                inputValue[cursor - 1] === '/');\n            // 10<day<31 && month<12 for input\n            const day2monthInput: boolean =\n              Number(inputValue.slice(cursor - 3, cursor - 1)) <= daysCount &&\n              !inputValue.slice(cursor - 3, cursor - 1).includes('/') &&\n              inputValue[cursor - 1] === '/' &&\n              (Number(inputValue.slice(cursor, cursor + 2)) > monthsCount || inputValue[cursor + 1] === '/');\n            // day<10 && month<12 for paste whole data\n            const day1monthPaste: boolean =\n              Number(inputValue.slice(cursor - 3, cursor - 1)) > daysCount &&\n              !inputValue.slice(cursor - 3, cursor - 1).includes('/') &&\n              !inputValue.slice(cursor - 2, cursor).includes('/') &&\n              Number(inputValue.slice(cursor - 2, cursor)) > monthsCount;\n            // 10<day<31 && month<12 for paste whole data\n            const day2monthPaste: boolean =\n              Number(inputValue.slice(cursor - 3, cursor - 1)) <= daysCount &&\n              !inputValue.slice(cursor - 3, cursor - 1).includes('/') &&\n              inputValue[cursor - 1] !== '/' &&\n              Number(inputValue.slice(cursor - 1, cursor + 1)) > monthsCount;\n\n            if (withoutDays || day1monthInput || day2monthInput || day1monthPaste || day2monthPaste) {\n              cursor += 1;\n              const shiftStep: number = /[*?]/g.test(maskExpression.slice(0, cursor)) ? inputArray.length : cursor;\n              this._shift.add(shiftStep + this.prefix.length || 0);\n              i--;\n              continue;\n            }\n          }\n          result += inputSymbol;\n          cursor++;\n        } else if (this.maskSpecialCharacters.indexOf(maskExpression[cursor]) !== -1) {\n          result += maskExpression[cursor];\n          cursor++;\n          const shiftStep: number = /[*?]/g.test(maskExpression.slice(0, cursor)) ? inputArray.length : cursor;\n          this._shift.add(shiftStep + this.prefix.length || 0);\n          i--;\n        } else if (\n          this.maskSpecialCharacters.indexOf(inputSymbol) > -1 &&\n          this.maskAvailablePatterns[maskExpression[cursor]] &&\n          this.maskAvailablePatterns[maskExpression[cursor]].optional\n        ) {\n          if (\n            !!inputArray[cursor] &&\n            maskExpression !== '099.099.099.099' &&\n            maskExpression !== '000.000.000-00' &&\n            maskExpression !== '00.000.000/0000-00'\n          ) {\n            result += inputArray[cursor];\n          }\n          cursor++;\n          i--;\n        } else if (\n          this.maskExpression[cursor + 1] === '*' &&\n          this._findSpecialChar(this.maskExpression[cursor + 2]) &&\n          this._findSpecialChar(inputSymbol) === this.maskExpression[cursor + 2] &&\n          multi\n        ) {\n          cursor += 3;\n          result += inputSymbol;\n        } else if (\n          this.maskExpression[cursor + 1] === '?' &&\n          this._findSpecialChar(this.maskExpression[cursor + 2]) &&\n          this._findSpecialChar(inputSymbol) === this.maskExpression[cursor + 2] &&\n          multi\n        ) {\n          cursor += 3;\n          result += inputSymbol;\n        } else if (\n          this.showMaskTyped &&\n          this.maskSpecialCharacters.indexOf(inputSymbol) < 0 &&\n          inputSymbol !== this.placeHolderCharacter\n        ) {\n          stepBack = true;\n        }\n      }\n    }\n    if (\n      result.length + 1 === maskExpression.length &&\n      this.maskSpecialCharacters.indexOf(maskExpression[maskExpression.length - 1]) !== -1\n    ) {\n      result += maskExpression[maskExpression.length - 1];\n    }\n\n    let newPosition: number = position + 1;\n\n    while (this._shift.has(newPosition)) {\n      shift++;\n      newPosition++;\n    }\n\n    let actualShift: number = this._shift.has(position) ? shift : 0;\n    if (stepBack) {\n      actualShift--;\n    }\n\n    cb(actualShift, backspaceShift);\n    if (shift < 0) {\n      this._shift.clear();\n    }\n    let res = `${this.prefix}${result}${this.suffix}`;\n    if (result.length === 0) {\n      res = `${this.prefix}${result}`;\n    }\n    return res;\n  }\n\n  public _findSpecialChar(inputSymbol: string): undefined | string {\n    return this.maskSpecialCharacters.find((val: string) => val === inputSymbol);\n  }\n\n  protected _checkSymbolMask(inputSymbol: string, maskSymbol: string): boolean {\n    this.maskAvailablePatterns = this.customPattern ? this.customPattern : this.maskAvailablePatterns;\n    return (\n      this.maskAvailablePatterns[maskSymbol] &&\n      this.maskAvailablePatterns[maskSymbol].pattern &&\n      this.maskAvailablePatterns[maskSymbol].pattern.test(inputSymbol)\n    );\n  }\n\n  private _formatWithSeparators = (\n    str: string,\n    thousandSeparatorChar: string,\n    decimalChar: string,\n    precision: number\n  ) => {\n    const x: string[] = str.split(decimalChar);\n    const decimals: string = x.length > 1 ? `${decimalChar}${x[1]}` : '';\n    let res: string = x[0];\n    const separatorLimit: string = this.separatorLimit.replace(/\\s/g, '');\n    if (separatorLimit && +separatorLimit) {\n      if (res[0] === '-') {\n        res = `-${res.slice(1, res.length).slice(0, separatorLimit.length)}`;\n      } else {\n        res = res.slice(0, separatorLimit.length);\n      }\n    }\n    const rgx: RegExp = /(\\d+)(\\d{3})/;\n\n    while (thousandSeparatorChar && rgx.test(res)) {\n      res = res.replace(rgx, '$1' + thousandSeparatorChar + '$2');\n    }\n\n    if (precision === undefined) {\n      return res + decimals;\n    } else if (precision === 0) {\n      return res;\n    }\n    return res + decimals.substr(0, precision + 1);\n  };\n\n  private percentage = (str: string): boolean => {\n    return Number(str) >= 0 && Number(str) <= 100;\n  };\n\n  private getPrecision = (maskExpression: string): number => {\n    const x: string[] = maskExpression.split('.');\n    if (x.length > 1) {\n      return Number(x[x.length - 1]);\n    }\n\n    return Infinity;\n  };\n\n  private checkInputPrecision = (\n    inputValue: string,\n    precision: number,\n    decimalMarker: IConfig['decimalMarker']\n  ): string => {\n    if (precision < Infinity) {\n      const precisionRegEx: RegExp = new RegExp(this._charToRegExpExpression(decimalMarker) + `\\\\d{${precision}}.*$`);\n\n      const precisionMatch: RegExpMatchArray | null = inputValue.match(precisionRegEx);\n      if (precisionMatch && precisionMatch[0].length - 1 > precision) {\n        const diff = precisionMatch[0].length - 1 - precision;\n        inputValue = inputValue.substring(0, inputValue.length - diff);\n      }\n      if (precision === 0 && inputValue.endsWith(decimalMarker)) {\n        inputValue = inputValue.substring(0, inputValue.length - 1);\n      }\n    }\n    return inputValue;\n  };\n\n  private _stripToDecimal(str: string): string {\n    return str\n      .split('')\n      .filter((i: string, idx: number) => {\n        return (\n          i.match('^-?\\\\d') ||\n          i.match('\\\\s') ||\n          i === '.' ||\n          i === ',' ||\n          (i === '-' && idx === 0 && this.allowNegativeNumbers)\n        );\n      })\n      .join('');\n  }\n\n  private _charToRegExpExpression(char: string): string {\n    if (char) {\n      const charsToEscape = '[\\\\^$.|?*+()';\n      return char === ' ' ? '\\\\s' : charsToEscape.indexOf(char) >= 0 ? '\\\\' + char : char;\n    }\n    return char;\n  }\n}\n","import { ElementRef, Inject, Injectable, Renderer2 } from '@angular/core';\nimport { DOCUMENT } from '@angular/common';\n\nimport { config, IConfig } from './config';\nimport { MaskApplierService } from './mask-applier.service';\n\n@Injectable()\nexport class MaskService extends MaskApplierService {\n  public maskExpression: string = '';\n  public isNumberValue: boolean = false;\n  public placeHolderCharacter: string = '_';\n  public maskIsShown: string = '';\n  public selStart: number | null = null;\n  public selEnd: number | null = null;\n\n  /**\n   * Whether we are currently in writeValue function, in this case when applying the mask we don't want to trigger onChange function,\n   * since writeValue should be a one way only process of writing the DOM value based on the Angular model value.\n   */\n  public writingValue: boolean = false;\n\n  private _formElement: HTMLInputElement;\n\n  public onChange = (_: any) => {};\n\n  public constructor(\n    @Inject(DOCUMENT) private document: any,\n    @Inject(config) protected _config: IConfig,\n    private _elementRef: ElementRef,\n    private _renderer: Renderer2\n  ) {\n    super(_config);\n    this._formElement = this._elementRef.nativeElement;\n  }\n\n  // tslint:disable-next-line:cyclomatic-complexity\n  public applyMask(inputValue: string, maskExpression: string, position: number = 0, cb: Function = () => {}): string {\n    if (!maskExpression) {\n      return inputValue;\n    }\n    this.maskIsShown = this.showMaskTyped ? this.showMaskInInput() : '';\n    if (this.maskExpression === 'IP' && this.showMaskTyped) {\n      this.maskIsShown = this.showMaskInInput(inputValue || '#');\n    }\n    if (this.maskExpression === 'CPF_CNPJ' && this.showMaskTyped) {\n      this.maskIsShown = this.showMaskInInput(inputValue || '#');\n    }\n    if (!inputValue && this.showMaskTyped) {\n      this.formControlResult(this.prefix);\n      return this.prefix + this.maskIsShown;\n    }\n    const getSymbol: string = !!inputValue && typeof this.selStart === 'number' ? inputValue[this.selStart] : '';\n    let newInputValue = '';\n    if (this.hiddenInput !== undefined) {\n      let actualResult: string[] = this.actualValue.split('');\n      // tslint:disable no-unused-expression\n      inputValue !== '' && actualResult.length\n        ? typeof this.selStart === 'number' && typeof this.selEnd === 'number'\n          ? inputValue.length > actualResult.length\n            ? actualResult.splice(this.selStart, 0, getSymbol)\n            : inputValue.length < actualResult.length\n            ? actualResult.length - inputValue.length === 1\n              ? actualResult.splice(this.selStart - 1, 1)\n              : actualResult.splice(this.selStart, this.selEnd - this.selStart)\n            : null\n          : null\n        : (actualResult = []);\n      // tslint:enable no-unused-expression\n      newInputValue = this.actualValue.length ? this.shiftTypedSymbols(actualResult.join('')) : inputValue;\n    }\n    newInputValue = Boolean(newInputValue) && newInputValue.length ? newInputValue : inputValue;\n    const result: string = super.applyMask(newInputValue, maskExpression, position, cb);\n    this.actualValue = this.getActualValue(result);\n\n    // handle some separator implications:\n    // a.) adjust decimalMarker default (. -> ,) if thousandSeparator is a dot\n    if (this.thousandSeparator === '.' && this.decimalMarker === '.') {\n      this.decimalMarker = ',';\n    }\n\n    // b) remove decimal marker from list of special characters to mask\n    if (this.maskExpression.startsWith('separator') && this.dropSpecialCharacters === true) {\n      this.maskSpecialCharacters = this.maskSpecialCharacters.filter((item: string) => item !== this.decimalMarker);\n    }\n\n    this.formControlResult(result);\n\n    if (!this.showMaskTyped) {\n      if (this.hiddenInput) {\n        return result && result.length ? this.hideInput(result, this.maskExpression) : result;\n      }\n      return result;\n    }\n    const resLen: number = result.length;\n    const prefNmask: string = this.prefix + this.maskIsShown;\n\n    if (this.maskExpression.includes('H')) {\n      const countSkipedSymbol = this._numberSkipedSymbols(result);\n      return result + prefNmask.slice(resLen + countSkipedSymbol);\n    } else if (this.maskExpression === 'IP' || this.maskExpression === 'CPF_CNPJ') {\n      return result + prefNmask;\n    }\n    return result + prefNmask.slice(resLen);\n  }\n\n  // get the number of characters that were shifted\n  private _numberSkipedSymbols(value: string): number {\n    const regex = /(^|\\D)(\\d\\D)/g;\n    let match = regex.exec(value);\n    let countSkipedSymbol = 0;\n    while (match != null) {\n      countSkipedSymbol += 1;\n      match = regex.exec(value);\n    }\n    return countSkipedSymbol;\n  }\n\n  public applyValueChanges(position: number = 0, cb: Function = () => {}): void {\n    this._formElement.value = this.applyMask(this._formElement.value, this.maskExpression, position, cb);\n    if (this._formElement === this.document.activeElement) {\n      return;\n    }\n    this.clearIfNotMatchFn();\n  }\n\n  public hideInput(inputValue: string, maskExpression: string): string {\n    return inputValue\n      .split('')\n      .map((curr: string, index: number) => {\n        if (\n          this.maskAvailablePatterns &&\n          this.maskAvailablePatterns[maskExpression[index]] &&\n          this.maskAvailablePatterns[maskExpression[index]].symbol\n        ) {\n          return this.maskAvailablePatterns[maskExpression[index]].symbol;\n        }\n        return curr;\n      })\n      .join('');\n  }\n\n  // this function is not necessary, it checks result against maskExpression\n  public getActualValue(res: string): string {\n    const compare: string[] = res\n      .split('')\n      .filter(\n        (symbol: string, i: number) =>\n          this._checkSymbolMask(symbol, this.maskExpression[i]) ||\n          (this.maskSpecialCharacters.includes(this.maskExpression[i]) && symbol === this.maskExpression[i])\n      );\n    if (compare.join('') === res) {\n      return compare.join('');\n    }\n    return res;\n  }\n\n  public shiftTypedSymbols(inputValue: string): string {\n    let symbolToReplace = '';\n    const newInputValue: string[] =\n      (inputValue &&\n        inputValue.split('').map((currSymbol: string, index: number) => {\n          if (\n            this.maskSpecialCharacters.includes(inputValue[index + 1]) &&\n            inputValue[index + 1] !== this.maskExpression[index + 1]\n          ) {\n            symbolToReplace = currSymbol;\n            return inputValue[index + 1];\n          }\n          if (symbolToReplace.length) {\n            const replaceSymbol: string = symbolToReplace;\n            symbolToReplace = '';\n            return replaceSymbol;\n          }\n          return currSymbol;\n        })) ||\n      [];\n    return newInputValue.join('');\n  }\n\n  public showMaskInInput(inputVal?: string): string {\n    if (this.showMaskTyped && !!this.shownMaskExpression) {\n      if (this.maskExpression.length !== this.shownMaskExpression.length) {\n        throw new Error('Mask expression must match mask placeholder length');\n      } else {\n        return this.shownMaskExpression;\n      }\n    } else if (this.showMaskTyped) {\n      if (inputVal) {\n        if (this.maskExpression === 'IP') {\n          return this._checkForIp(inputVal);\n        }\n        if (this.maskExpression === 'CPF_CNPJ') {\n          return this._checkForCpfCnpj(inputVal);\n        }\n      }\n      return this.maskExpression.replace(/\\w/g, this.placeHolderCharacter);\n    }\n    return '';\n  }\n\n  public clearIfNotMatchFn(): void {\n    if (\n      this.clearIfNotMatch &&\n      this.prefix.length + this.maskExpression.length + this.suffix.length !==\n        this._formElement.value.replace(/_/g, '').length\n    ) {\n      this.formElementProperty = ['value', ''];\n      this.applyMask(this._formElement.value, this.maskExpression);\n    }\n  }\n\n  public set formElementProperty([name, value]: [string, string | boolean]) {\n    this._renderer.setProperty(this._formElement, name, value);\n  }\n\n  public checkSpecialCharAmount(mask: string): number {\n    const chars: string[] = mask.split('').filter((item: string) => this._findSpecialChar(item));\n    return chars.length;\n  }\n\n  public removeMask(inputValue: string): string {\n    return this._removeMask(\n      this._removeSuffix(this._removePrefix(inputValue)),\n      this.maskSpecialCharacters.concat('_').concat(this.placeHolderCharacter)\n    );\n  }\n\n  private _checkForIp(inputVal: string): string {\n    if (inputVal === '#') {\n      return `${this.placeHolderCharacter}.${this.placeHolderCharacter}.${this.placeHolderCharacter}.${this.placeHolderCharacter}`;\n    }\n    const arr: string[] = [];\n    for (let i = 0; i < inputVal.length; i++) {\n      if (inputVal[i].match('\\\\d')) {\n        arr.push(inputVal[i]);\n      }\n    }\n    if (arr.length <= 3) {\n      return `${this.placeHolderCharacter}.${this.placeHolderCharacter}.${this.placeHolderCharacter}`;\n    }\n    if (arr.length > 3 && arr.length <= 6) {\n      return `${this.placeHolderCharacter}.${this.placeHolderCharacter}`;\n    }\n    if (arr.length > 6 && arr.length <= 9) {\n      return this.placeHolderCharacter;\n    }\n    if (arr.length > 9 && arr.length <= 12) {\n      return '';\n    }\n    return '';\n  }\n\n  private _checkForCpfCnpj(inputVal: string): string {\n    const cpf =\n      `${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}` +\n      `.${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}` +\n      `.${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}` +\n      `-${this.placeHolderCharacter}${this.placeHolderCharacter}`;\n    const cnpj =\n      `${this.placeHolderCharacter}${this.placeHolderCharacter}` +\n      `.${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}` +\n      `.${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}` +\n      `/${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}` +\n      `-${this.placeHolderCharacter}${this.placeHolderCharacter}`;\n\n    if (inputVal === '#') {\n      return cpf;\n    }\n    const arr: string[] = [];\n    for (let i = 0; i < inputVal.length; i++) {\n      if (inputVal[i].match('\\\\d')) {\n        arr.push(inputVal[i]);\n      }\n    }\n    if (arr.length <= 3) {\n      return cpf.slice(arr.length, cpf.length);\n    }\n    if (arr.length > 3 && arr.length <= 6) {\n      return cpf.slice(arr.length + 1, cpf.length);\n    }\n    if (arr.length > 6 && arr.length <= 9) {\n      return cpf.slice(arr.length + 2, cpf.length);\n    }\n    if (arr.length > 9 && arr.length < 11) {\n      return cpf.slice(arr.length + 3, cpf.length);\n    }\n    if (arr.length === 11) {\n      return '';\n    }\n    if (arr.length === 12) {\n      if (inputVal.length === 17) {\n        return cnpj.slice(16, cnpj.length);\n      }\n      return cnpj.slice(15, cnpj.length);\n    }\n    if (arr.length > 12 && arr.length <= 14) {\n      return cnpj.slice(arr.length + 4, cnpj.length);\n    }\n    return '';\n  }\n\n  /**\n   * Propogates the input value back to the Angular model by triggering the onChange function. It won't do this if writingValue\n   * is true. If that is true it means we are currently in the writeValue function, which is supposed to only update the actual\n   * DOM element based on the Angular model value. It should be a one way process, i.e. writeValue should not be modifying the Angular\n   * model value too. Therefore, we don't trigger onChange in this scenario.\n   * @param inputValue the current form input value\n   */\n  private formControlResult(inputValue: string): void {\n    if (!this.writingValue) {\n      if (Array.isArray(this.dropSpecialCharacters)) {\n        this.onChange(this._removeMask(this._removeSuffix(this._removePrefix(inputValue)), this.dropSpecialCharacters));\n      } else if (this.dropSpecialCharacters) {\n        this.onChange(this._checkSymbols(inputValue));\n      } else {\n        this.onChange(this._removeSuffix(this._removePrefix(inputValue)));\n      }\n    }\n  }\n\n  private _removeMask(value: string, specialCharactersForRemove: string[]): string {\n    return value ? value.replace(this._regExpForRemove(specialCharactersForRemove), '') : value;\n  }\n\n  private _removePrefix(value: string): string {\n    if (!this.prefix) {\n      return value;\n    }\n    return value ? value.replace(this.prefix, '') : value;\n  }\n\n  private _removeSuffix(value: string): string {\n    if (!this.suffix) {\n      return value;\n    }\n    return value ? value.replace(this.suffix, '') : value;\n  }\n\n  private _retrieveSeparatorValue(result: string): string {\n    return this._removeMask(this._removeSuffix(this._removePrefix(result)), this.maskSpecialCharacters);\n  }\n\n  private _regExpForRemove(specialCharactersForRemove: string[]): RegExp {\n    return new RegExp(specialCharactersForRemove.map((item: string) => `\\\\${item}`).join('|'), 'gi');\n  }\n\n  private _checkSymbols(result: string): string | number | undefined | null {\n    if (result === '') {\n      return result;\n    }\n\n    const separatorPrecision: number | null = this._retrieveSeparatorPrecision(this.maskExpression);\n    let separatorValue: string = this._retrieveSeparatorValue(result);\n    if (this.decimalMarker !== '.') {\n      separatorValue = separatorValue.replace(this.decimalMarker, '.');\n    }\n\n    if (this.isNumberValue) {\n      if (separatorPrecision) {\n        if (result === this.decimalMarker) {\n          return null;\n        }\n        return this._checkPrecision(this.maskExpression, separatorValue);\n      } else {\n        return Number(separatorValue);\n      }\n    } else {\n      return separatorValue;\n    }\n  }\n\n  // TODO should think about helpers or separting decimal precision to own property\n  private _retrieveSeparatorPrecision(maskExpretion: string): number | null {\n    const matcher: RegExpMatchArray | null = maskExpretion.match(new RegExp(`^separator\\\\.([^d]*)`));\n    return matcher ? Number(matcher[1]) : null;\n  }\n\n  private _checkPrecision(separatorExpression: string, separatorValue: string): number | string {\n    if (separatorExpression.indexOf('2') > 0) {\n      return Number(separatorValue).toFixed(2);\n    }\n    return Number(separatorValue);\n  }\n}\n","import {\n  ControlValueAccessor,\n  FormControl,\n  NG_VALIDATORS,\n  NG_VALUE_ACCESSOR,\n  ValidationErrors,\n  Validator,\n} from '@angular/forms';\nimport { Directive, forwardRef, HostListener, Inject, Input, OnChanges, SimpleChanges } from '@angular/core';\nimport { DOCUMENT } from '@angular/common';\n\nimport { CustomKeyboardEvent } from './custom-keyboard-event';\nimport { config, IConfig, timeMasks, withoutValidation } from './config';\nimport { MaskService } from './mask.service';\n\n// tslint:disable deprecation\n// tslint:disable no-input-rename\n@Directive({\n  selector: 'input[mask], textarea[mask]',\n  providers: [\n    {\n      provide: NG_VALUE_ACCESSOR,\n      useExisting: forwardRef(() => MaskDirective),\n      multi: true,\n    },\n    {\n      provide: NG_VALIDATORS,\n      useExisting: forwardRef(() => MaskDirective),\n      multi: true,\n    },\n    MaskService,\n  ],\n})\nexport class MaskDirective implements ControlValueAccessor, OnChanges, Validator {\n  @Input('mask') public maskExpression: string = '';\n  @Input() public specialCharacters: IConfig['specialCharacters'] = [];\n  @Input() public patterns: IConfig['patterns'] = {};\n  @Input() public prefix: IConfig['prefix'] = '';\n  @Input() public suffix: IConfig['suffix'] = '';\n  @Input() public thousandSeparator: IConfig['thousandSeparator'] = ' ';\n  @Input() public decimalMarker: IConfig['decimalMarker'] = '.';\n  @Input() public dropSpecialCharacters: IConfig['dropSpecialCharacters'] | null = null;\n  @Input() public hiddenInput: IConfig['hiddenInput'] | null = null;\n  @Input() public showMaskTyped: IConfig['showMaskTyped'] | null = null;\n  @Input() public placeHolderCharacter: IConfig['placeHolderCharacter'] | null = null;\n  @Input() public shownMaskExpression: IConfig['shownMaskExpression'] | null = null;\n  @Input() public showTemplate: IConfig['showTemplate'] | null = null;\n  @Input() public clearIfNotMatch: IConfig['clearIfNotMatch'] | null = null;\n  @Input() public validation: IConfig['validation'] | null = null;\n  @Input() public separatorLimit: IConfig['separatorLimit'] | null = null;\n  @Input() public allowNegativeNumbers: IConfig['allowNegativeNumbers'] | null = null;\n  private _maskValue: string = '';\n  private _inputValue!: string;\n  private _position: number | null = null;\n  private _start!: number;\n  private _end!: number;\n  private _code!: string;\n  private _maskExpressionArray: string[] = [];\n\n  public constructor(\n    @Inject(DOCUMENT) private document: any,\n    private _maskService: MaskService,\n    @Inject(config) protected _config: IConfig\n  ) {}\n\n  public onChange = (_: any) => {};\n  public onTouch = () => {};\n\n  public ngOnChanges(changes: SimpleChanges): void {\n    const {\n      maskExpression,\n      specialCharacters,\n      patterns,\n      prefix,\n      suffix,\n      thousandSeparator,\n      decimalMarker,\n      dropSpecialCharacters,\n      hiddenInput,\n      showMaskTyped,\n      placeHolderCharacter,\n      shownMaskExpression,\n      showTemplate,\n      clearIfNotMatch,\n      validation,\n      separatorLimit,\n      allowNegativeNumbers,\n    } = changes;\n    if (maskExpression) {\n      this._maskValue = maskExpression.currentValue || '';\n      if (maskExpression.currentValue && maskExpression.currentValue.split('||').length > 1) {\n        this._maskExpressionArray = maskExpression.currentValue.split('||').sort((a: string, b: string) => {\n          return a.length - b.length;\n        });\n        this._maskValue = this._maskExpressionArray[0];\n        this.maskExpression = this._maskExpressionArray[0];\n        this._maskService.maskExpression = this._maskExpressionArray[0];\n      }\n    }\n    if (specialCharacters) {\n      if (!specialCharacters.currentValue || !Array.isArray(specialCharacters.currentValue)) {\n        return;\n      } else {\n        this._maskService.maskSpecialCharacters = specialCharacters.currentValue || [];\n      }\n    }\n    // Only overwrite the mask available patterns if a pattern has actually been passed in\n    if (patterns && patterns.currentValue) {\n      this._maskService.maskAvailablePatterns = patterns.currentValue;\n    }\n    if (prefix) {\n      this._maskService.prefix = prefix.currentValue;\n    }\n    if (suffix) {\n      this._maskService.suffix = suffix.currentValue;\n    }\n    if (thousandSeparator) {\n      this._maskService.thousandSeparator = thousandSeparator.currentValue;\n    }\n    if (decimalMarker) {\n      this._maskService.decimalMarker = decimalMarker.currentValue;\n    }\n    if (dropSpecialCharacters) {\n      this._maskService.dropSpecialCharacters = dropSpecialCharacters.currentValue;\n    }\n    if (hiddenInput) {\n      this._maskService.hiddenInput = hiddenInput.currentValue;\n    }\n    if (showMaskTyped) {\n      this._maskService.showMaskTyped = showMaskTyped.currentValue;\n    }\n    if (placeHolderCharacter) {\n      this._maskService.placeHolderCharacter = placeHolderCharacter.currentValue;\n    }\n    if (shownMaskExpression) {\n      this._maskService.shownMaskExpression = shownMaskExpression.currentValue;\n    }\n    if (showTemplate) {\n      this._maskService.showTemplate = showTemplate.currentValue;\n    }\n    if (clearIfNotMatch) {\n      this._maskService.clearIfNotMatch = clearIfNotMatch.currentValue;\n    }\n    if (validation) {\n      this._maskService.validation = validation.currentValue;\n    }\n    if (separatorLimit) {\n      this._maskService.separatorLimit = separatorLimit.currentValue;\n    }\n    if (allowNegativeNumbers) {\n      this._maskService.allowNegativeNumbers = allowNegativeNumbers.currentValue;\n      if (this._maskService.allowNegativeNumbers) {\n        this._maskService.maskSpecialCharacters = this._maskService.maskSpecialCharacters.filter(\n          (c: string) => c !== '-'\n        );\n      }\n    }\n    this._applyMask();\n  }\n\n  // tslint:disable-next-line: cyclomatic-complexity\n  public validate({ value }: FormControl): ValidationErrors | null {\n    if (!this._maskService.validation || !this._maskValue) {\n      return null;\n    }\n    if (this._maskService.ipError) {\n      return this._createValidationError(value);\n    }\n    if (this._maskService.cpfCnpjError) {\n      return this._createValidationError(value);\n    }\n    if (this._maskValue.startsWith('separator')) {\n      return null;\n    }\n    if (withoutValidation.includes(this._maskValue)) {\n      return null;\n    }\n    if (this._maskService.clearIfNotMatch) {\n      return null;\n    }\n    if (timeMasks.includes(this._maskValue)) {\n      return this._validateTime(value);\n    }\n    if (value && value.toString().length >= 1) {\n      let counterOfOpt = 0;\n      for (const key in this._maskService.maskAvailablePatterns) {\n        if (\n          this._maskService.maskAvailablePatterns[key].optional &&\n          this._maskService.maskAvailablePatterns[key].optional === true\n        ) {\n          if (this._maskValue.indexOf(key) !== this._maskValue.lastIndexOf(key)) {\n            const opt: string = this._maskValue\n              .split('')\n              .filter((i: string) => i === key)\n              .join('');\n            counterOfOpt += opt.length;\n          } else if (this._maskValue.indexOf(key) !== -1) {\n            counterOfOpt++;\n          }\n          if (this._maskValue.indexOf(key) !== -1 && value.toString().length >= this._maskValue.indexOf(key)) {\n            return null;\n          }\n          if (counterOfOpt === this._maskValue.length) {\n            return null;\n          }\n        }\n      }\n      if (\n        this._maskValue.indexOf('{') === 1 &&\n        value.toString().length === this._maskValue.length + Number(this._maskValue.split('{')[1].split('}')[0]) - 4\n      ) {\n        return null;\n      }\n      if (this._maskValue.indexOf('*') === 1 || this._maskValue.indexOf('?') === 1) {\n        return null;\n      } else if (\n        (this._maskValue.indexOf('*') > 1 && value.toString().length < this._maskValue.indexOf('*')) ||\n        (this._maskValue.indexOf('?') > 1 && value.toString().length < this._maskValue.indexOf('?')) ||\n        this._maskValue.indexOf('{') === 1\n      ) {\n        return this._createValidationError(value);\n      }\n      if (this._maskValue.indexOf('*') === -1 || this._maskValue.indexOf('?') === -1) {\n        const length: number = this._maskService.dropSpecialCharacters\n          ? this._maskValue.length - this._maskService.checkSpecialCharAmount(this._maskValue) - counterOfOpt\n          : this._maskValue.length - counterOfOpt;\n        if (value.toString().length < length) {\n          return this._createValidationError(value);\n        }\n      }\n    }\n    return null;\n  }\n\n  @HostListener('input', ['$event'])\n  public onInput(e: CustomKeyboardEvent): void {\n    const el: HTMLInputElement = e.target as HTMLInputElement;\n    this._inputValue = el.value;\n\n    this._setMask();\n\n    if (!this._maskValue) {\n      this.onChange(el.value);\n      return;\n    }\n    const position: number =\n      el.selectionStart === 1\n        ? (el.selectionStart as number) + this._maskService.prefix.length\n        : (el.selectionStart as number);\n    let caretShift = 0;\n    let backspaceShift = false;\n    this._maskService.applyValueChanges(position, (shift: number, _backspaceShift: boolean) => {\n      caretShift = shift;\n      backspaceShift = _backspaceShift;\n    });\n    // only set the selection if the element is active\n    if (this.document.activeElement !== el) {\n      return;\n    }\n    this._position = this._position === 1 && this._inputValue.length === 1 ? null : this._position;\n    let positionToApply: number = this._position\n      ? this._inputValue.length + position + caretShift\n      : position + (this._code === 'Backspace' && !backspaceShift ? 0 : caretShift);\n    if (positionToApply > this._getActualInputLength()) {\n      positionToApply = this._getActualInputLength();\n    }\n    el.setSelectionRange(positionToApply, positionToApply);\n    this._position = null;\n  }\n\n  @HostListener('blur')\n  public onBlur(): void {\n    if (this._maskValue) {\n      this._maskService.clearIfNotMatchFn();\n    }\n    this.onTouch();\n  }\n\n  @HostListener('click', ['$event'])\n  public onFocus(e: MouseEvent | CustomKeyboardEvent): void {\n    if (!this._maskValue) {\n      return;\n    }\n    const el: HTMLInputElement = e.target as HTMLInputElement;\n    const posStart = 0;\n    const posEnd = 0;\n    if (\n      el !== null &&\n      el.selectionStart !== null &&\n      el.selectionStart === el.selectionEnd &&\n      el.selectionStart > this._maskService.prefix.length &&\n      // tslint:disable-next-line\n      (e as any).keyCode !== 38\n    )\n      if (this._maskService.showMaskTyped) {\n        // We are showing the mask in the input\n        this._maskService.maskIsShown = this._maskService.showMaskInInput();\n        if (el.setSelectionRange && this._maskService.prefix + this._maskService.maskIsShown === el.value) {\n          // the input ONLY contains the mask, so position the cursor at the start\n          el.focus();\n          el.setSelectionRange(posStart, posEnd);\n        } else {\n          // the input contains some characters already\n          if (el.selectionStart > this._maskService.actualValue.length) {\n            // if the user clicked beyond our value's length, position the cursor at the end of our value\n            el.setSelectionRange(this._maskService.actualValue.length, this._maskService.actualValue.length);\n          }\n        }\n      }\n    const nextValue: string | null =\n      !el.value || el.value === this._maskService.prefix\n        ? this._maskService.prefix + this._maskService.maskIsShown\n        : el.value;\n\n    /** Fix of cursor position jumping to end in most browsers no matter where cursor is inserted onFocus */\n    if (el.value !== nextValue) {\n      el.value = nextValue;\n    }\n\n    /** fix of cursor position with prefix when mouse click occur */\n    if (((el.selectionStart as number) || (el.selectionEnd as number)) <= this._maskService.prefix.length) {\n      el.selectionStart = this._maskService.prefix.length;\n      return;\n    }\n\n    /** select only inserted text */\n    if ((el.selectionEnd as number) > this._getActualInputLength()) {\n      el.selectionEnd = this._getActualInputLength();\n    }\n  }\n\n  // tslint:disable-next-line: cyclomatic-complexity\n  @HostListener('keydown', ['$event'])\n  public onKeyDown(e: CustomKeyboardEvent): void {\n    if (!this._maskValue) {\n      return;\n    }\n    this._code = e.code ? e.code : e.key;\n    const el: HTMLInputElement = e.target as HTMLInputElement;\n    this._inputValue = el.value;\n\n    this._setMask();\n\n    if (e.keyCode === 38) {\n      e.preventDefault();\n    }\n    if (e.keyCode === 37 || e.keyCode === 8 || e.keyCode === 46) {\n      if (e.keyCode === 8 && el.value.length === 0) {\n        el.selectionStart = el.selectionEnd;\n      }\n      if (e.keyCode === 8 && (el.selectionStart as number) !== 0) {\n        // If specialChars is false, (shouldn't ever happen) then set to the defaults\n        this.specialCharacters = this.specialCharacters?.length\n          ? this.specialCharacters\n          : this._config.specialCharacters;\n        if (this.prefix.length > 1 && (el.selectionStart as number) <= this.prefix.length) {\n          el.setSelectionRange(this.prefix.length, this.prefix.length);\n        } else {\n          if (this._inputValue.length !== (el.selectionStart as number) && (el.selectionStart as number) !== 1) {\n            while (\n              this.specialCharacters.includes(this._inputValue[(el.selectionStart as number) - 1].toString()) &&\n              ((this.prefix.length >= 1 && (el.selectionStart as number) > this.prefix.length) ||\n                this.prefix.length === 0)\n            ) {\n              el.setSelectionRange((el.selectionStart as number) - 1, (el.selectionStart as number) - 1);\n            }\n          }\n          this.suffixCheckOnPressDelete(e.keyCode, el);\n        }\n      }\n      this.suffixCheckOnPressDelete(e.keyCode, el);\n      if (\n        this._maskService.prefix.length &&\n        (el.selectionStart as number) <= this._maskService.prefix.length &&\n        (el.selectionEnd as number) <= this._maskService.prefix.length\n      ) {\n        e.preventDefault();\n      }\n      const cursorStart: number | null = el.selectionStart;\n      // this.onFocus(e);\n      if (\n        e.keyCode === 8 &&\n        !el.readOnly &&\n        cursorStart === 0 &&\n        el.selectionEnd === el.value.length &&\n        el.value.length !== 0\n      ) {\n        this._position = this._maskService.prefix ? this._maskService.prefix.length : 0;\n        this._maskService.applyMask(this._maskService.prefix, this._maskService.maskExpression, this._position);\n      }\n    }\n    if (\n      !!this.suffix &&\n      this.suffix.length > 1 &&\n      this._inputValue.length - this.suffix.length < (el.selectionStart as number)\n    ) {\n      el.setSelectionRange(this._inputValue.length - this.suffix.length, this._inputValue.length);\n    } else if (\n      (e.keyCode === 65 && e.ctrlKey === true) || // Ctrl+ A\n      (e.keyCode === 65 && e.metaKey === true) // Cmd + A (Mac)\n    ) {\n      el.setSelectionRange(0, this._getActualInputLength());\n      e.preventDefault();\n    }\n    this._maskService.selStart = el.selectionStart;\n    this._maskService.selEnd = el.selectionEnd;\n  }\n\n  /** It writes the value in the input */\n  public async writeValue(inputValue: string | number): Promise<void> {\n    if (inputValue === undefined) {\n      inputValue = '';\n    }\n    if (typeof inputValue === 'number') {\n      inputValue = String(inputValue);\n      inputValue = this.decimalMarker !== '.' ? inputValue.replace('.', this.decimalMarker) : inputValue;\n      this._maskService.isNumberValue = true;\n    }\n    if (\n      (inputValue && this._maskService.maskExpression) ||\n      (this._maskService.maskExpression && (this._maskService.prefix || this._maskService.showMaskTyped))\n    ) {\n      // Let the service we know we are writing value so that triggering onChange function wont happen during applyMask\n      this._maskService.writingValue = true;\n      this._maskService.formElementProperty = [\n        'value',\n        this._maskService.applyMask(inputValue, this._maskService.maskExpression),\n      ];\n      // Let the service know we've finished writing value\n      this._maskService.writingValue = false;\n    } else {\n      this._maskService.formElementProperty = ['value', inputValue];\n    }\n    this._inputValue = inputValue;\n  }\n\n  public registerOnChange(fn: any): void {\n    this.onChange = fn;\n    this._maskService.onChange = this.onChange;\n  }\n\n  public registerOnTouched(fn: any): void {\n    this.onTouch = fn;\n  }\n\n  public suffixCheckOnPressDelete(keyCode: number, el: HTMLInputElement): void {\n    if (keyCode === 46 && this.suffix.length > 0) {\n      if (this._inputValue.length - this.suffix.length <= (el.selectionStart as number)) {\n        el.setSelectionRange(this._inputValue.length - this.suffix.length, this._inputValue.length);\n      }\n    }\n    if (keyCode === 8) {\n      if (this.suffix.length > 1 && this._inputValue.length - this.suffix.length < (el.selectionStart as number)) {\n        el.setSelectionRange(this._inputValue.length - this.suffix.length, this._inputValue.length);\n      }\n      if (this.suffix.length === 1 && this._inputValue.length === (el.selectionStart as number)) {\n        el.setSelectionRange((el.selectionStart as number) - 1, (el.selectionStart as number) - 1);\n      }\n    }\n  }\n\n  /** It disables the input element */\n  public setDisabledState(isDisabled: boolean): void {\n    this._maskService.formElementProperty = ['disabled', isDisabled];\n  }\n\n  @HostListener('ngModelChange', ['$event'])\n  // tslint:disable-next-line: no-any\n  public onModelChange(e: any): void {\n    if (!e) {\n      this._maskService.actualValue = '';\n    }\n  }\n\n  private _repeatPatternSymbols(maskExp: string): string {\n    return (\n      (maskExp.match(/{[0-9]+}/) &&\n        maskExp.split('').reduce((accum: string, currval: string, index: number): string => {\n          this._start = currval === '{' ? index : this._start;\n\n          if (currval !== '}') {\n            return this._maskService._findSpecialChar(currval) ? accum + currval : accum;\n          }\n          this._end = index;\n          const repeatNumber: number = Number(maskExp.slice(this._start + 1, this._end));\n          const repaceWith: string = new Array(repeatNumber + 1).join(maskExp[this._start - 1]);\n          return accum + repaceWith;\n        }, '')) ||\n      maskExp\n    );\n  }\n  // tslint:disable-next-line:no-any\n  private _applyMask(): any {\n    this._maskService.maskExpression = this._repeatPatternSymbols(this._maskValue || '');\n    this._maskService.formElementProperty = [\n      'value',\n      this._maskService.applyMask(this._inputValue, this._maskService.maskExpression),\n    ];\n  }\n\n  private _validateTime(value: string): ValidationErrors | null {\n    const rowMaskLen: number = this._maskValue.split('').filter((s: string) => s !== ':').length;\n    if (value === null || value.length === 0) {\n      return null; // Don't validate empty values to allow for optional form control\n    }\n\n    if ((+value[value.length - 1] === 0 && value.length < rowMaskLen) || value.length <= rowMaskLen - 2) {\n      return this._createValidationError(value);\n    }\n\n    return null;\n  }\n\n  private _getActualInputLength() {\n    return (\n      this._maskService.actualValue.length || this._maskService.actualValue.length + this._maskService.prefix.length\n    );\n  }\n\n  private _createValidationError(actualValue: string): ValidationErrors {\n    return {\n      mask: {\n        requiredMask: this._maskValue,\n        actualValue,\n      },\n    };\n  }\n\n  private _setMask() {\n    if (this._maskExpressionArray.length > 0) {\n      this._maskExpressionArray.some((mask) => {\n        const test = this._maskService.removeMask(this._inputValue).length <= this._maskService.removeMask(mask).length;\n        if (this._inputValue && test) {\n          this._maskValue = mask;\n          this.maskExpression = mask;\n          this._maskService.maskExpression = mask;\n          return test;\n        } else {\n          this._maskValue = this._maskExpressionArray[this._maskExpressionArray.length - 1];\n          this.maskExpression = this._maskExpressionArray[this._maskExpressionArray.length - 1];\n          this._maskService.maskExpression = this._maskExpressionArray[this._maskExpressionArray.length - 1];\n        }\n      });\n    }\n  }\n}\n","import { Pipe, PipeTransform } from '@angular/core';\n\nimport { MaskApplierService } from './mask-applier.service';\nimport { IConfig } from './config';\n\n@Pipe({\n  name: 'mask',\n  pure: true,\n})\nexport class MaskPipe implements PipeTransform {\n  public constructor(private _maskService: MaskApplierService) {}\n\n  public transform(\n    value: string | number,\n    mask: string | [string, IConfig['patterns']],\n    thousandSeparator: string | null = null\n  ): string {\n    if (!value && typeof value !== 'number') {\n      return '';\n    }\n    if (thousandSeparator) {\n      this._maskService.thousandSeparator = thousandSeparator;\n    }\n    if (typeof mask === 'string') {\n      return this._maskService.applyMask(`${value}`, mask);\n    }\n    return this._maskService.applyMaskWithPattern(`${value}`, mask);\n  }\n}\n","import { ModuleWithProviders, NgModule } from '@angular/core';\n\nimport { config, INITIAL_CONFIG, initialConfig, NEW_CONFIG, optionsConfig } from './config';\nimport { MaskApplierService } from './mask-applier.service';\nimport { MaskDirective } from './mask.directive';\nimport { MaskPipe } from './mask.pipe';\n\n@NgModule({\n  exports: [MaskDirective, MaskPipe],\n  declarations: [MaskDirective, MaskPipe],\n})\nexport class NgxMaskModule {\n  public static forRoot(configValue?: optionsConfig | (() => optionsConfig)): ModuleWithProviders<NgxMaskModule> {\n    return {\n      ngModule: NgxMaskModule,\n      providers: [\n        {\n          provide: NEW_CONFIG,\n          useValue: configValue,\n        },\n        {\n          provide: INITIAL_CONFIG,\n          useValue: initialConfig,\n        },\n        {\n          provide: config,\n          useFactory: _configFactory,\n          deps: [INITIAL_CONFIG, NEW_CONFIG],\n        },\n        MaskApplierService,\n      ],\n    };\n  }\n  public static forChild(): ModuleWithProviders<NgxMaskModule> {\n    return {\n      ngModule: NgxMaskModule,\n    };\n  }\n}\n\n/**\n * @internal\n */\nexport function _configFactory(\n  initConfig: optionsConfig,\n  configValue: optionsConfig | (() => optionsConfig)\n): optionsConfig {\n  return configValue instanceof Function ? { ...initConfig, ...configValue() } : { ...initConfig, ...configValue };\n}\n","// tslint:disable: no-any typedef\ndeclare var global: any;\n\nconst commonjsGlobal =\n    typeof globalThis !== 'undefined' ? globalThis :\n        typeof window !== 'undefined' ? window :\n            typeof global !== 'undefined' ? global :\n                typeof self !== 'undefined' ? self :\n                    {};\n\n(function() {\n    if (!commonjsGlobal.KeyboardEvent) {\n        commonjsGlobal.KeyboardEvent = function(_eventType: any, _init: any) { };\n    }\n})();\n\nexport type CustomKeyboardEvent = KeyboardEvent;\n"]}